<!--
Copyright (c) 2019-2021 TUXEDO Computers GmbH <tux@tuxedocomputers.com>

This file is part of TUXEDO Control Center.

TUXEDO Control Center is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

TUXEDO Control Center is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with TUXEDO Control Center.  If not, see <https://www.gnu.org/licenses/>.
-->

<mat-card class="tcc-card card-support">
    <mat-card-title class="theme-page-title">
        <ng-container i18n>TUXEDO Tomte</ng-container>
    </mat-card-title>
    <hr />

    <div class="content-container centered">
        <p i18n>TUXEDO Tomte is a configuration service that automatically recognizes the customer's device and checks
            for missing drivers or required packages, relieving users of tedious troubleshooting and problem solving.
        </p>
    </div>
</mat-card>


<ng-container *ngIf="tomteIsInstalled === 'false'">

    <mat-card class="tcc-card card-support">
        <mat-card-title class="theme-page-title">
            <ng-container i18n>Install TUXEDO Tomte</ng-container>
        </mat-card-title>
        <hr />
    
        <div class="content-container centered">
            <p i18n>
                Install TUXEDO Tomte now by pressing this button:
            </p>
            <button mat-raised-button color="primary" (click)="installTomteButton()">Install TUXEDO Tomte</button>
        </div>
    </mat-card>


</ng-container>

<ng-container *ngIf="!tomteMode && tomteIsInstalled === 'true'">
    <mat-card class="tcc-card card-support">
        <mat-card-title class="theme-page-title">
            <ng-container i18n>TUXEDO Tomte not producing output</ng-container>
        </mat-card-title>
        <hr />
    
        <div class="content-container centered">
            <p i18n>
                TUXEDO Tomte seems to be installed, but is not producing any output. This could mean that you are using a non TUXEDO device or a TUXEDO desktop. If you are using a TUXEDO laptop this could mean that something went wrong. TUXEDO Tomtes job is it to automatically install fixes for TUXEDO laptops, so if you are experiencing problems—like a non-working touchpad—and see this message, contact our tech support telling them that tomte is installed but seems to not work properly. 
            </p>
        </div>
    </mat-card>

</ng-container>

<ng-container *ngIf="tomteMode && tomteIsInstalled === 'true'">

    <mat-card class="tcc-card card-support">
        <mat-card-title class="theme-page-title">
            <ng-container i18n>Selected installation mode</ng-container>
        </mat-card-title>
        <hr />
        <div class="content-container centered">
            <p i18n>Select the mode in which tomte is supposed to operate. Do you want it to handle things
                automatically, or configure it on your own?</p>
            <div style="text-align: center">
                <button style="display: inline-block" mat-raised-button color="primary" [disabled]="tomteMode===tomteModes[0]"
                    (click)="tomteModeButton(tomteModes[0])"
                    matTooltip="This is the  default  mode.  Everything  will  be  installed/updated/removed automatically by Tomte.">
                    <ng-container>Automatic</ng-container>
                </button>
                <button style="display: inline-block; margin-left: 5px" mat-raised-button color="primary" [disabled]="tomteMode===tomteModes[1]"
                    (click)="tomteModeButton(tomteModes[1])"
                    matTooltip="Only updates will be handled automatically by Tomte. No modules will be installed or removed without user intervention.">
                    <ng-container>Updates Only</ng-container>
                </button>
                <button style="display: inline-block; margin-left: 5px" mat-raised-button color="primary" [disabled]="tomteMode===tomteModes[2]"
                    (click)="tomteModeButton(tomteModes[2])" matTooltip="Nothing will be configured by Tomte.">
                    <ng-container>Disabled</ng-container>
                </button>
            </div>
        </div>
    </mat-card>

    <ng-container *ngIf="tomteMode !== 'DONT_CONFIGURE'">
        <mat-card class="tcc-card card-support">
            <mat-card-title class="theme-page-title">
                <ng-container i18n>Tomte Configuration</ng-container>
            </mat-card-title>
            <hr />
            <div class="content-container centered">
                <p i18n>See what packages tomte is handling and block or uninstall them as needed.</p>

                <table mat-table [dataSource]="tomteListArray" class="mat-elevation-z2" style="width: 100%">

                    <ng-container matColumnDef="moduleName">
                        <th mat-header-cell *matHeaderCellDef> Module name </th>
                        <td mat-cell *matCellDef="let line"> {{line[0]}}</td>
                    </ng-container>

                    <ng-container matColumnDef="moduleVersion">
                        <th mat-header-cell *matHeaderCellDef> Version </th>
                        <td mat-cell *matCellDef="let line"> {{line[1]}}</td>
                    </ng-container>

                    <ng-container matColumnDef="moduleInstalled">
                        <th mat-header-cell *matHeaderCellDef> Installed </th>
                        <td mat-cell *matCellDef="let line">
                            <mat-slide-toggle 
                            class="green-slide-toggle"
                            [disabled]="line[4] === 'prerequisite' || line[3] === 'yes'"
                            [checked]="line[2] === 'yes'"
                            (change)="tomteUn_InstallButton(line[0],line[2],line[3])"
                            [matTooltip]="line[3] === 'yes' ? 'Cannot un-/install a module that is blocked.' : (line[4] === 'prerequisite' ? 'Cannot uninstall a module that is a prerequisite' : (line[2] === 'no' ? 'Install this module' : 'Uninstall this module'))"
                            >
                        
                            </mat-slide-toggle>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="moduleBlocked">
                        <th mat-header-cell *matHeaderCellDef> Active </th>
                        <td mat-cell *matCellDef="let line">                       
                            <mat-slide-toggle 
                            class="green-slide-toggle"
                            [disabled]="line[4] === 'prerequisite'"
                            [checked]="line[3] === 'no'"
                            (change)="tomteBlockButton(line[0],line[3])"
                            [matTooltip]="line[4] === 'prerequisite' ? 'Cannot block a module that is a prerequisite' : (line[3] === 'no' ? 'Block this module' : 'Unblock this module')"
                            >
                        
                            </mat-slide-toggle> 
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="moduleRequired">
                        <th mat-header-cell *matHeaderCellDef> Required </th>
                        <td mat-cell *matCellDef="let line"> {{line[4]}}</td>
                    </ng-container>

                    <ng-container matColumnDef="moduleDescription">
                        <th mat-header-cell *matHeaderCellDef> Info </th>
                        <td mat-cell *matCellDef="let line"> 
                            <mat-icon
                            class="info-icon"
                            [matTooltip]="moduleToolTips.get(line[0])"
                            [matTooltipShowDelay]="infoTooltipShowDelay"
                            >
                            <svg viewBox="0 0 512 512"><use href="./assets/images/icon_info.svg#Icon"></use></svg>
                        </mat-icon>

                        </td>
                    </ng-container>


                    <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                    <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"></tr>
                </table>

            </div>
        </mat-card>
    </ng-container>
    <mat-card class="tcc-card card-support">
        <mat-card-title class="theme-page-title">
            <ng-container i18n>Reset to defaults</ng-container>
        </mat-card-title>
        <hr />
        <div class="content-container centered">
            <button mat-raised-button color="primary" (click)="tomteResetToDefaults()" matTooltip="Reset Configuration to defaults.">
                <p i18n>Reset</p>
        </button>
        </div>
    </mat-card>

</ng-container>

<br />
<br />
<br />