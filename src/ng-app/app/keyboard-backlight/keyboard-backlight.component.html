<!--
Copyright (c) 2019-2020 TUXEDO Computers GmbH <tux@tuxedocomputers.com>

This file is part of TUXEDO Control Center.

TUXEDO Control Center is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

TUXEDO Control Center is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with TUXEDO Control Center.  If not, see <https://www.gnu.org/licenses/>.
-->

<mat-card class="tcc-card card-keyboard-backlight">
    <mat-card-title class="theme-page-title">
        <ng-container i18n="@@cKeyboardBacklightLabel">Keyboard Backlight</ng-container>
    </mat-card-title>
    <hr />
    
    <div class="content-container centered">
        <p i18n="@@cKeyboardBacklightDescription">Control the Keyboard Backlight</p>
    </div>

    <div class="keyboard-backlight-content content" *ngIf="keyboardBacklightCapabilities === undefined">
        <p i18n="@@cKeyboardBacklightNotSupported">Your device has no keyboard backlight or is not (yet) supported by this control interface.</p>
    </div>

    <div class="keyboard-backlight-content content" *ngIf="keyboardBacklightCapabilities !== undefined">
        <div *ngIf="keyboardBacklightCapabilities.maxRed > 0 && keyboardBacklightCapabilities.maxGreen > 0 && keyboardBacklightCapabilities.maxBlue > 0">
            <div *ngIf="keyboardBacklightCapabilities.zones >= 1 && keyboardBacklightCapabilities.zones <= 4">
                <mat-grid-list [cols]="9" rowHeight="1227:2709" class="keyboard-color-grid">
                    <mat-grid-tile [colspan]="1"></mat-grid-tile>
                    <mat-grid-tile [colspan]="7">
                        <svg viewBox="-1 -1 1227 387">
                            <g class="key-group" (click)="onKeyboardImageClick(0)">
                                <path [ngClass]="{ 'key-background-selected': keyboardBacklightCapabilities.zones > 1 && selectedZone == 0, 'key-background-unselected': selectedZone != 0 }"
                                    id="zoneBackground0"
                                    style="stroke-width:6"
                                    d="M 1.5,1.5 V 33.023436 H 58.781247 V 1.5 Z m 136.96094,0 v 31.523436 h 57.35938 V 1.5 Z m 68.56055,0 v 31.523436 h 57.36133 V 1.5 Z m 68.39843,0 v 31.523436 h 57.36133 V 1.5 Z M 69.980467,1.503906 v 31.51953 H 127.33985 V 1.503906 Z M 1.5,44.943356 V 102.94336 H 50.460937 V 44.943356 Z m 58.640627,0 V 102.94336 H 118.14063 V 44.943356 Z m 71.839843,0 v 58.000004 h 57.91992 V 44.943356 Z m 71.75977,0 v 58.000004 h 58 V 44.943356 Z m 71.83984,0 v 58.000004 h 57.99024 V 44.943356 Z M 1.5,114.86329 v 58 h 84.878907 v -58 z m 94.560547,0 v 58 h 57.919923 v -58 z m 71.839843,0 v 58 h 57.91993 v -58 z m 71.75977,0 v 58 h 58 v -58 z M 1.5,184.78321 v 58 h 102.79883 v -58 z m 112.48047,0 v 58 h 58 v -58 z m 71.83008,0 v 58 h 58 v -58 z m 71.84961,0 v 58 h 57.91992 v -58 z M 82.298827,254.70313 v 57.91211 h 57.912113 v -57.91211 z m 139.441413,0 v 57.91992 h 57.91992 V 254.70313 Z M 1.5,254.70513 v 57.91992 h 66.878907 v -57.91992 z m 148.41211,0 v 57.91797 h 58 v -57.91797 z m 143.58985,0 v 57.91992 h 57.99023 V 254.70508 Z M 1.5,324.625 v 57.91993 H 68.380857 V 324.625 Z m 80.802737,0 v 57.91993 H 140.22266 V 324.625 Z m 67.599613,0 v 57.91797 h 58 V 324.625 Z m 71.83984,0 v 57.91993 h 57.91992 V 324.625 Z"
                                />
                                <path
                                    id="zone0"
                                    style="fill:none;stroke-width:3;"
                                    [style.stroke]="chosenColorHex[0]"
                                    d="M 1.5,1.5 V 33.023436 H 58.781247 V 1.5 Z m 136.96094,0 v 31.523436 h 57.35938 V 1.5 Z m 68.56055,0 v 31.523436 h 57.36133 V 1.5 Z m 68.39843,0 v 31.523436 h 57.36133 V 1.5 Z M 69.980467,1.503906 v 31.51953 H 127.33985 V 1.503906 Z M 1.5,44.943356 V 102.94336 H 50.460937 V 44.943356 Z m 58.640627,0 V 102.94336 H 118.14063 V 44.943356 Z m 71.839843,0 v 58.000004 h 57.91992 V 44.943356 Z m 71.75977,0 v 58.000004 h 58 V 44.943356 Z m 71.83984,0 v 58.000004 h 57.99024 V 44.943356 Z M 1.5,114.86329 v 58 h 84.878907 v -58 z m 94.560547,0 v 58 h 57.919923 v -58 z m 71.839843,0 v 58 h 57.91993 v -58 z m 71.75977,0 v 58 h 58 v -58 z M 1.5,184.78321 v 58 h 102.79883 v -58 z m 112.48047,0 v 58 h 58 v -58 z m 71.83008,0 v 58 h 58 v -58 z m 71.84961,0 v 58 h 57.91992 v -58 z M 82.298827,254.70313 v 57.91211 h 57.912113 v -57.91211 z m 139.441413,0 v 57.91992 h 57.91992 V 254.70313 Z M 1.5,254.70513 v 57.91992 h 66.878907 v -57.91992 z m 148.41211,0 v 57.91797 h 58 v -57.91797 z m 143.58985,0 v 57.91992 h 57.99023 V 254.70508 Z M 1.5,324.625 v 57.91993 H 68.380857 V 324.625 Z m 80.802737,0 v 57.91993 H 140.22266 V 324.625 Z m 67.599613,0 v 57.91797 h 58 V 324.625 Z m 71.83984,0 v 57.91993 h 57.91992 V 324.625 Z"
                                />
                            </g>
                            <g class="key-group" (click)="onKeyboardImageClick(1)">
                                <path [ngClass]="{ 'key-background-selected': keyboardBacklightCapabilities.zones > 1 && selectedZone == 1, 'key-background-unselected': selectedZone != 1 }"
                                    id="zoneBackground1"
                                    style="stroke-width:6"
                                    d="m 343.90039,1.5 v 31.523436 h 57.35938 V 1.5 Z m 68.73243,0 v 31.523436 h 57.27929 V 1.5 Z m 68.22851,0 v 31.523436 h 57.35938 V 1.5 Z m 68.47852,0 v 31.523436 h 57.36133 V 1.5 Z m 68.47851,0 v 31.523436 h 57.36133 V 1.5 Z m 68.48242,0 v 31.523436 h 57.35938 V 1.5 Z m 68.47852,0 v 31.523436 h 57.36133 V 1.5 Z m 68.48047,0 V 33.023436 H 880.6211 V 1.5 Z M 347.41992,44.943356 v 58.000004 h 57.91993 V 44.943356 Z m 143.60547,0 v 58.000004 h 57.91602 V 44.943356 Z m 71.75586,0.002 v 57.990234 h 57.99024 V 44.945356 Z m 71.83985,0 v 57.990234 h 57.99023 V 44.945356 Z m 72.95898,0 v 58.000004 h 56.80078 V 44.945356 Z m 71.75977,0 v 58.000004 h 56.88086 V 44.945356 Z m -360.1543,0.004 V 102.9396 h 57.99023 V 44.949216 Z M 311.5,114.86329 v 58 h 57.91992 v -58 z m 71.75977,0.002 v 57.99023 h 57.99219 v -57.99023 z m 71.8418,0 v 57.99023 h 57.99023 v -57.99023 z m 71.83984,0 v 58 h 57.91992 v -58 z m 71.75977,0 v 57.99023 h 57.99023 v -57.99023 z m 71.83984,0 v 58 h 57.92187 v -58 z m 71.76172,0 v 57.99023 h 57.99023 v -57.99023 z m 71.83789,0 v 57.99023 h 57.99023 v -57.99028 z m -412.88086,69.91792 v 56.80078 h 57.91992 v -56.80078 z m 71.76172,0 v 57.99218 h 57.99023 v -57.99218 z m 71.83984,0 v 57.99218 h 57.99024 v -57.99218 z m 71.83985,0 v 58 h 57.91992 v -58 z m 71.75976,0 v 57.99218 h 57.99024 v -57.99218 z m 143.68164,0 v 58 h 57.91992 v -58 z m -502.72266,0.002 v 57.99023 h 57.99219 v -57.99023 z m 430.88477,0.002 v 57.9961 h 57.91602 v -57.9961 z m -323.125,69.91602 v 57.91992 h 57.92188 v -57.91992 z m 143.60156,0 v 57.91992 h 57.91993 v -57.91992 z m 215.43946,0 v 57.91992 h 57.91992 v -57.91992 z m -430.88086,0.002 v 57.91797 h 57.99218 v -57.91797 z m 287.20117,0 v 57.91797 h 57.99219 v -57.91797 z m 71.83984,0 v 57.91797 h 58 v -57.91797 z m -215.43945,0.008 v 57.91016 h 57.99023 v -57.91016 z m 215.43945,69.83008 v 57.99219 h 57.99024 v -57.99219 z m 71.83985,0.002 v 58 h 84.88086 v -58 z M 293.5,324.62541 v 57.91993 h 345.28125 v -57.91993 z m 359.04102,0 v 57.91993 h 57.99023 v -57.91993 z"
                                />
                                <path
                                    id="zone1"
                                    style="fill:none;stroke-width:3"
                                    [style.stroke]="chosenColorHex[1]"
                                    d="m 343.90039,1.5 v 31.523436 h 57.35938 V 1.5 Z m 68.73243,0 v 31.523436 h 57.27929 V 1.5 Z m 68.22851,0 v 31.523436 h 57.35938 V 1.5 Z m 68.47852,0 v 31.523436 h 57.36133 V 1.5 Z m 68.47851,0 v 31.523436 h 57.36133 V 1.5 Z m 68.48242,0 v 31.523436 h 57.35938 V 1.5 Z m 68.47852,0 v 31.523436 h 57.36133 V 1.5 Z m 68.48047,0 V 33.023436 H 880.6211 V 1.5 Z M 347.41992,44.943356 v 58.000004 h 57.91993 V 44.943356 Z m 143.60547,0 v 58.000004 h 57.91602 V 44.943356 Z m 71.75586,0.002 v 57.990234 h 57.99024 V 44.945356 Z m 71.83985,0 v 57.990234 h 57.99023 V 44.945356 Z m 72.95898,0 v 58.000004 h 56.80078 V 44.945356 Z m 71.75977,0 v 58.000004 h 56.88086 V 44.945356 Z m -360.1543,0.004 V 102.9396 h 57.99023 V 44.949216 Z M 311.5,114.86329 v 58 h 57.91992 v -58 z m 71.75977,0.002 v 57.99023 h 57.99219 v -57.99023 z m 71.8418,0 v 57.99023 h 57.99023 v -57.99023 z m 71.83984,0 v 58 h 57.91992 v -58 z m 71.75977,0 v 57.99023 h 57.99023 v -57.99023 z m 71.83984,0 v 58 h 57.92187 v -58 z m 71.76172,0 v 57.99023 h 57.99023 v -57.99023 z m 71.83789,0 v 57.99023 h 57.99023 v -57.99028 z m -412.88086,69.91792 v 56.80078 h 57.91992 v -56.80078 z m 71.76172,0 v 57.99218 h 57.99023 v -57.99218 z m 71.83984,0 v 57.99218 h 57.99024 v -57.99218 z m 71.83985,0 v 58 h 57.91992 v -58 z m 71.75976,0 v 57.99218 h 57.99024 v -57.99218 z m 143.68164,0 v 58 h 57.91992 v -58 z m -502.72266,0.002 v 57.99023 h 57.99219 v -57.99023 z m 430.88477,0.002 v 57.9961 h 57.91602 v -57.9961 z m -323.125,69.91602 v 57.91992 h 57.92188 v -57.91992 z m 143.60156,0 v 57.91992 h 57.91993 v -57.91992 z m 215.43946,0 v 57.91992 h 57.91992 v -57.91992 z m -430.88086,0.002 v 57.91797 h 57.99218 v -57.91797 z m 287.20117,0 v 57.91797 h 57.99219 v -57.91797 z m 71.83984,0 v 57.91797 h 58 v -57.91797 z m -215.43945,0.008 v 57.91016 h 57.99023 v -57.91016 z m 215.43945,69.83008 v 57.99219 h 57.99024 v -57.99219 z m 71.83985,0.002 v 58 h 84.88086 v -58 z M 293.5,324.62541 v 57.91993 h 345.28125 v -57.91993 z m 359.04102,0 v 57.91993 h 57.99023 v -57.91993 z"
                                />
                            </g>
                            <g class="key-group" (click)="onKeyboardImageClick(2)">
                                <path [ngClass]="{ 'key-background-selected': keyboardBacklightCapabilities.zones > 1 && selectedZone == 2, 'key-background-unselected': selectedZone != 2 }"
                                    id="zoneBackground2"
                                    style="stroke-width:6"
                                    d="M 891.74024,1.5 V 33.023436 H 949.0996 V 1.5 Z m 68.48046,0 v 31.523436 h 57.3594 V 1.5 Z m 68.4785,0 v 31.523436 h 57.3613 V 1.5 Z m 68.4805,0 v 31.523436 h 57.3594 V 1.5 Z m 68.959,0 V 33.023436 H 1223.5 V 1.5 Z M 917.7402,44.943356 V 102.94336 H 1020.541 V 44.943356 Z m -67.67965,0.002 v 57.990234 h 57.99023 V 44.945356 Z m 180.16995,0 V 102.9434 h 57.9902 V 44.945356 Z m 67.6699,0 V 102.9434 h 57.9199 V 44.945356 Z m 67.6035,0 v 57.990234 h 57.9922 V 44.945356 Z M 953.5781,114.86333 v 58 h 66.961 v -58 z m -67.59763,0.002 v 58 h 57.91993 v -58 z m 144.25003,0 v 57.99023 h 57.9902 v -57.99023 z m 135.2734,0 v 57.99023 h 57.9922 v -57.99023 z m -67.6035,0.002 v 57.99805 h 57.9199 v -57.99819 z m -194.00196,69.91588 v 57.99218 h 57.99216 v -57.99218 z m 67.67966,0 v 58 h 48.961 v -58 z m 193.9258,0 v 57.99218 h 57.9922 v -57.99218 z m -135.2734,0.002 v 57.99805 h 57.9902 v -57.99805 z m 67.6699,0 v 57.99805 h 57.9199 v -57.9981 z m -229.91993,69.9062 V 312.625 h 84.96093 v -57.93359 z m 94.64063,0.01 v 57.92187 h 57.9199 v -57.92187 z m 67.6094,0.004 v 57.99805 h 57.9902 v -57.99805 z m 67.6699,0 v 57.99805 h 57.9199 v -57.99805 z m 67.6035,0 v 57.99024 h 57.9922 v -57.99024 z m -135.2734,69.91016 v 58 h 57.9902 v -58 z m 67.6699,0 v 58 h 57.9199 v -58 z m 67.6035,0 v 57.99219 h 57.9922 v -57.99219 z m -202.8828,0.008 v 57.92188 h 57.9199 v -57.92188 z m -67.67969,0.0176 v 57.90234 h 57.99999 v -57.90234 z"
                                />
                                <path
                                    id="zone2"
                                    style="fill:none;stroke-width:3"
                                    [style.stroke]="chosenColorHex[2]"
                                    d="M 891.74024,1.5 V 33.023436 H 949.0996 V 1.5 Z m 68.48046,0 v 31.523436 h 57.3594 V 1.5 Z m 68.4785,0 v 31.523436 h 57.3613 V 1.5 Z m 68.4805,0 v 31.523436 h 57.3594 V 1.5 Z m 68.959,0 V 33.023436 H 1223.5 V 1.5 Z M 917.7402,44.943356 V 102.94336 H 1020.541 V 44.943356 Z m -67.67965,0.002 v 57.990234 h 57.99023 V 44.945356 Z m 180.16995,0 V 102.9434 h 57.9902 V 44.945356 Z m 67.6699,0 V 102.9434 h 57.9199 V 44.945356 Z m 67.6035,0 v 57.990234 h 57.9922 V 44.945356 Z M 953.5781,114.86333 v 58 h 66.961 v -58 z m -67.59763,0.002 v 58 h 57.91993 v -58 z m 144.25003,0 v 57.99023 h 57.9902 v -57.99023 z m 135.2734,0 v 57.99023 h 57.9922 v -57.99023 z m -67.6035,0.002 v 57.99805 h 57.9199 v -57.99819 z m -194.00196,69.91588 v 57.99218 h 57.99216 v -57.99218 z m 67.67966,0 v 58 h 48.961 v -58 z m 193.9258,0 v 57.99218 h 57.9922 v -57.99218 z m -135.2734,0.002 v 57.99805 h 57.9902 v -57.99805 z m 67.6699,0 v 57.99805 h 57.9199 v -57.9981 z m -229.91993,69.9062 V 312.625 h 84.96093 v -57.93359 z m 94.64063,0.01 v 57.92187 h 57.9199 v -57.92187 z m 67.6094,0.004 v 57.99805 h 57.9902 v -57.99805 z m 67.6699,0 v 57.99805 h 57.9199 v -57.99805 z m 67.6035,0 v 57.99024 h 57.9922 v -57.99024 z m -135.2734,69.91016 v 58 h 57.9902 v -58 z m 67.6699,0 v 58 h 57.9199 v -58 z m 67.6035,0 v 57.99219 h 57.9922 v -57.99219 z m -202.8828,0.008 v 57.92188 h 57.9199 v -57.92188 z m -67.67969,0.0176 v 57.90234 h 57.99999 v -57.90234 z"
                                />
                            </g>
                        </svg>
                    </mat-grid-tile>
                    <mat-grid-tile [colspan]="1"></mat-grid-tile>
                </mat-grid-list>
            </div>
        </div>

        <mat-grid-list [cols]="9" rowHeight="3em" class="keyboard-backlight-grid" *ngIf="keyboardBacklightCapabilities.maxBrightness > 0">
            <mat-grid-tile [colspan]="1"></mat-grid-tile>
            <mat-grid-tile [colspan]="3"><header i18n="@@cKeyboardBacklightBrightnessLabel">Backlight Brightness:</header></mat-grid-tile>
            <mat-grid-tile [colspan]="1"><content class="value" style="text-align: center">{{ brightnessSlider.percent * 100 | number: '1.0-1' }}%</content></mat-grid-tile>
            <mat-grid-tile [colspan]="3">
                <div class="align-top-right-container">
                    <button mat-icon-button color="primary"
                        (mousedown)="buttonRepeatDown(modifySliderInputFunc(brightnessSlider, -1, brightnessSlider.min, brightnessSlider.max))"
                        (mouseup)="buttonRepeatUp()"
                        (mouseleave)="buttonRepeatUp()">
                        <mat-icon>remove</mat-icon>
                    </button>
                    <button mat-icon-button color="primary"
                        (mousedown)="buttonRepeatDown(modifySliderInputFunc(brightnessSlider, +1, brightnessSlider.min, brightnessSlider.max))"
                        (mouseup)="buttonRepeatUp()"
                        (mouseleave)="buttonRepeatUp()">
                        <mat-icon>add</mat-icon>
                    </button>
                    <mat-slider #brightnessSlider
                        [value]="chosenBrightness"
                        min="0"
                        [max]="keyboardBacklightCapabilities.maxBrightness"
                        step="1"
                        color="primary"
                        (input)="onBrightnessSliderInput($event)"
                        (onTouched)="onBrightnessSliderTouched($event)"
                        (change)="onBrightnessSliderChange($event)">
                    </mat-slider>
                </div>
            </mat-grid-tile>
            <mat-grid-tile [colspan]="1"></mat-grid-tile>
        </mat-grid-list>

        <mat-grid-list [cols]="9" rowHeight="20em" class="keyboard-backlight-grid" *ngIf="keyboardBacklightCapabilities.maxRed > 0 && keyboardBacklightCapabilities.maxGreen > 0 && keyboardBacklightCapabilities.maxBlue > 0">
            <mat-grid-tile [colspan]="1"></mat-grid-tile>
            <mat-grid-tile [colspan]="3">
                <div class="align-top-container">
                    <header i18n="@@cKeyboardBacklightColorLabel">Backlight Color:</header>
                </div>
            </mat-grid-tile>
            <mat-grid-tile [colspan]="1"></mat-grid-tile>
            <mat-grid-tile [colspan]="3">
                <div class="align-top-right-container">
                    <span class="color-visualizer"
                    [style.background]="chosenColorHex[selectedZone]"
                    [colorPicker]="chosenColorHex[selectedZone]"
                    cpToggle="true"
                    cpDialogDisplay="inline"
                    cpAlphaChannel="disabled"
                    (cpSliderChange)="onColorPickerInput($event, selectedZone)"
                    (cpInputChange)="onColorPickerInput($event, selectedZone)"
                    (cpSliderDragStart)="onColorPickerDragStart($event, selectedZone)"
                    (cpSliderDragEnd)="onColorPickerDragEnd($event, selectedZone)"></span>
                </div>
            </mat-grid-tile>
            <mat-grid-tile [colspan]="1"></mat-grid-tile>
        </mat-grid-list>
    </div>
</mat-card>
